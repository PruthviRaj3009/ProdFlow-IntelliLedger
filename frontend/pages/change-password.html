<!doctype html>
<html lang="en" data-theme="light">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Change Password â€” Distributor &amp; Sub-Distributor Console</title>

  <link rel="stylesheet" href="../css/theme.css" />
  <link rel="stylesheet" href="../css/base.css" />
  <link rel="stylesheet" href="../css/layout.css" />
  <link rel="stylesheet" href="../css/components.css" />
  <link rel="stylesheet" href="../css/change-password.css" />
</head>
<body>
  <!--
    Change Password (UI-only)
    Enterprise-grade screen for roles: Super Admin, Master Distributor, Distributor, Sub-Distributor.

    Notes:
    - No backend logic
    - Frontend validation only
    - Optional UX: "You will be logged out after changing your password." (UI only)
  -->

  <div class="pf-app">
    <aside class="pf-sidebar" aria-label="Sidebar">
      <div class="pf-topbar"><strong style="font-size:13px;">ProdFlow-IntelliLedger</strong></div>
      <nav id="sidebarNav" style="padding:12px 10px;">
        <a data-nav href="dashboard.html" style="display:block;padding:10px 12px;border-radius:12px;text-decoration:none;">Dashboard</a>
        <a data-nav href="products.html" style="display:block;padding:10px 12px;border-radius:12px;text-decoration:none;">Products</a>
        <a data-nav href="inventory.html" style="display:block;padding:10px 12px;border-radius:12px;text-decoration:none;">Inventory</a>
        <a data-nav href="ledger.html" style="display:block;padding:10px 12px;border-radius:12px;text-decoration:none;">Ledger</a>
        <a data-nav data-requires-role="admin,distributor" href="users.html" style="display:block;padding:10px 12px;border-radius:12px;text-decoration:none;">Users</a>
        <a data-nav href="change-password.html" style="display:block;padding:10px 12px;border-radius:12px;text-decoration:none;">Change Password</a>
      </nav>
    </aside>

    <div>
      <header class="pf-topbar">
        <div>
          <div style="font-weight:800; letter-spacing:-0.2px;">Change Password</div>
          <div class="pf-muted" style="font-size:12px;">For security reasons, please update your password regularly.</div>
        </div>
        <div style="display:flex;gap:10px;align-items:center;">
          <span id="sessionRole" class="pf-badge" title="Simulated role"></span>
          <button id="logoutBtn" class="pf-btn" style="border:1px solid var(--pf-border);background:var(--pf-surface);">Logout</button>
        </div>
      </header>

      <main class="pf-main">
        <section class="pf-security-page" aria-label="Change Password">
          <div class="pf-security-card">
            <div class="pf-security-header">
              <h1 class="pf-security-title">Change Password</h1>
              <p class="pf-security-subtitle">For security reasons, please update your password regularly.</p>
            </div>

            <!-- Feedback states (UI-only) -->
            <div id="cpSuccess" class="pf-alert pf-alert--success" role="status" aria-live="polite" hidden>
              Password updated successfully.
            </div>
            <div id="cpError" class="pf-alert" role="alert" aria-live="polite" hidden>
              Current password is incorrect.
            </div>

            <form id="changePasswordForm" novalidate>
              <div class="pf-field">
                <label class="pf-label" for="currentPassword">Current Password</label>
                <div class="pf-input-row">
                  <input id="currentPassword" class="pf-input" type="password" autocomplete="current-password" required />
                  <button type="button" class="pf-icon-btn" data-toggle="currentPassword" aria-label="Show current password" aria-pressed="false">
                    <svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" focusable="false">
                      <path d="M12 5c5.5 0 9.7 4.1 11 7-1.3 2.9-5.5 7-11 7S2.3 15.9 1 12c1.3-2.9 5.5-7 11-7Zm0 2C7.6 7 4.1 10 3.1 12 4.1 14 7.6 17 12 17s7.9-3 8.9-5C19.9 10 16.4 7 12 7Zm0 2.5A2.5 2.5 0 1 1 9.5 12 2.5 2.5 0 0 1 12 9.5Z" fill="currentColor"/>
                    </svg>
                  </button>
                </div>
                <div id="curMsg" class="pf-inline-msg" aria-live="polite"></div>
              </div>

              <div class="pf-field">
                <label class="pf-label" for="newPassword">New Password</label>
                <div class="pf-input-row">
                  <input id="newPassword" class="pf-input" type="password" autocomplete="new-password" required />
                  <button type="button" class="pf-icon-btn" data-toggle="newPassword" aria-label="Show new password" aria-pressed="false">
                    <svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" focusable="false">
                      <path d="M12 5c5.5 0 9.7 4.1 11 7-1.3 2.9-5.5 7-11 7S2.3 15.9 1 12c1.3-2.9 5.5-7 11-7Zm0 2C7.6 7 4.1 10 3.1 12 4.1 14 7.6 17 12 17s7.9-3 8.9-5C19.9 10 16.4 7 12 7Zm0 2.5A2.5 2.5 0 1 1 9.5 12 2.5 2.5 0 0 1 12 9.5Z" fill="currentColor"/>
                    </svg>
                  </button>
                </div>

                <!-- Strength indicator -->
                <div class="pf-strength" aria-label="Password strength">
                  <div class="pf-strength-bar" aria-hidden="true"><span id="strengthFill"></span></div>
                  <div class="pf-strength-label">
                    <span class="pf-muted">Strength</span>
                    <span id="strengthPill" class="pf-strength-pill" data-level="weak">Weak</span>
                  </div>
                </div>

                <!-- Inline helper text (required rules) -->
                <ul class="pf-help-list" aria-label="Password requirements">
                  <li class="pf-help-item" id="ruleLen"><span class="pf-help-dot" aria-hidden="true"></span><span>Minimum 8 characters</span></li>
                  <li class="pf-help-item" id="ruleUpper"><span class="pf-help-dot" aria-hidden="true"></span><span>At least 1 uppercase letter</span></li>
                  <li class="pf-help-item" id="ruleNum"><span class="pf-help-dot" aria-hidden="true"></span><span>At least 1 number</span></li>
                  <li class="pf-help-item" id="ruleSpecial"><span class="pf-help-dot" aria-hidden="true"></span><span>At least 1 special character</span></li>
                </ul>

                <div id="newMsg" class="pf-inline-msg" aria-live="polite"></div>
              </div>

              <div class="pf-field">
                <label class="pf-label" for="confirmPassword">Confirm New Password</label>
                <div class="pf-input-row">
                  <input id="confirmPassword" class="pf-input" type="password" autocomplete="new-password" required />
                  <button type="button" class="pf-icon-btn" data-toggle="confirmPassword" aria-label="Show confirm password" aria-pressed="false">
                    <svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" focusable="false">
                      <path d="M12 5c5.5 0 9.7 4.1 11 7-1.3 2.9-5.5 7-11 7S2.3 15.9 1 12c1.3-2.9 5.5-7 11-7Zm0 2C7.6 7 4.1 10 3.1 12 4.1 14 7.6 17 12 17s7.9-3 8.9-5C19.9 10 16.4 7 12 7Zm0 2.5A2.5 2.5 0 1 1 9.5 12 2.5 2.5 0 0 1 12 9.5Z" fill="currentColor"/>
                    </svg>
                  </button>
                </div>
                <div id="matchMsg" class="pf-inline-msg" aria-live="polite"></div>
              </div>

              <p class="pf-muted" style="font-size:12px;margin:6px 0 0 0;">
                Optional note: You will be logged out after changing your password.
              </p>

              <div class="pf-actions">
                <button id="updateBtn" class="pf-btn pf-btn--primary" type="submit" disabled>Update Password</button>
                <a id="cancelBtn" class="pf-btn pf-btn--secondary" href="dashboard.html" role="button" aria-label="Cancel password change">Cancel</a>
              </div>
            </form>
          </div>
        </section>
      </main>
    </div>
  </div>

  <script src="../js/utils.js"></script>
  <script src="../js/auth.js"></script>
  <script src="../js/navigation.js"></script>
  <script src="../js/change-password.js"></script>
</body>
</html>
